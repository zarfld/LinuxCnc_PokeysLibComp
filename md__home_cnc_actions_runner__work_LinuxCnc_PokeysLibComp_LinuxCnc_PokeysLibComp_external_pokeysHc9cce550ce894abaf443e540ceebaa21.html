<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.4"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>LinuxCNC PoKeysLib-Comp: PoNET and kbd48CNC Async Implementation Analysis</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="custom_doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign">
   <div id="projectname">LinuxCNC PoKeysLib-Comp
   </div>
   <div id="projectbrief">unofficial PoKeys HAL-Component for LinuxCNC</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.4 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('md__home_cnc_actions_runner__work_LinuxCnc_PokeysLibComp_LinuxCnc_PokeysLibComp_external_pokeysHc9cce550ce894abaf443e540ceebaa21.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">PoNET and kbd48CNC Async Implementation Analysis </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="autotoc_md290"></a>
üéØ &lt;strong&gt;Assessment Results: kbd48CNC Support Analysis&lt;/strong&gt;</h1>
<p >After analyzing the <a class="el" href="PoKeysCompPoNet_8c.html">PoKeysCompPoNet.c</a> implementation and reviewing the kbd48CNC device capabilities, I can confirm that our async library now has <b>comprehensive PoNET and kbd48CNC support</b>.</p>
<hr  />
<h1><a class="anchor" id="autotoc_md292"></a>
üìã &lt;strong&gt;Current Implementation Status&lt;/strong&gt;</h1>
<h2><a class="anchor" id="autotoc_md293"></a>
‚úÖ &lt;strong&gt;Existing PoNET Async Functions (PoKeysLibPoNETAsync.c)&lt;/strong&gt;</h2>
<div class="fragment"><div class="line"><span class="comment">// Basic PoNET Operations - Already Implemented</span></div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="PoKeysLibAsync_8h.html#ae30d618a9ef584142fd9569030f0a842">PK_PoNETGetPoNETStatusAsync</a>(<a class="code hl_struct" href="structsPoKeysDevice.html">sPoKeysDevice</a>* device);</div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="PoKeysLibAsync_8h.html#abf6e043583e7f2e498881fe18717d3ec">PK_PoNETGetModuleSettingsAsync</a>(<a class="code hl_struct" href="structsPoKeysDevice.html">sPoKeysDevice</a>* device);</div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="PoKeysLibAsync_8h.html#a06569777b67554ecb5b8d2313aaa0043">PK_PoNETGetModuleStatusRequestAsync</a>(<a class="code hl_struct" href="structsPoKeysDevice.html">sPoKeysDevice</a>* device);</div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="PoKeysLibAsync_8h.html#a8d522e5440b51d57c64449f9709f0f5d">PK_PoNETGetModuleStatusAsync</a>(<a class="code hl_struct" href="structsPoKeysDevice.html">sPoKeysDevice</a>* device);</div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="PoKeysLibAsync_8h.html#a37a28fc2391a33de6bb4f0529408cc0b">PK_PoNETSetModuleStatusAsync</a>(<a class="code hl_struct" href="structsPoKeysDevice.html">sPoKeysDevice</a>* device);</div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="PoKeysLibAsync_8h.html#a545d854e41e3d2a894d3e57e16ae5841">PK_PoNETSetModulePWMAsync</a>(<a class="code hl_struct" href="structsPoKeysDevice.html">sPoKeysDevice</a>* device);</div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="PoKeysLibAsync_8h.html#af2afc2d1a902285c403724e18e0d0d93">PK_PoNETGetModuleLightRequestAsync</a>(<a class="code hl_struct" href="structsPoKeysDevice.html">sPoKeysDevice</a>* device);</div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="PoKeysLibAsync_8h.html#a3c12276881f3b45c56244c9b1aae51d7">PK_PoNETGetModuleLightAsync</a>(<a class="code hl_struct" href="structsPoKeysDevice.html">sPoKeysDevice</a>* device);</div>
<div class="ttc" id="aPoKeysLibAsync_8h_html_a06569777b67554ecb5b8d2313aaa0043"><div class="ttname"><a href="PoKeysLibAsync_8h.html#a06569777b67554ecb5b8d2313aaa0043">PK_PoNETGetModuleStatusRequestAsync</a></div><div class="ttdeci">int PK_PoNETGetModuleStatusRequestAsync(sPoKeysDevice *device)</div><div class="ttdef"><b>Definition:</b> <a href="PoKeysLibPoNETAsync_8c_source.html#l00069">PoKeysLibPoNETAsync.c:69</a></div></div>
<div class="ttc" id="aPoKeysLibAsync_8h_html_a37a28fc2391a33de6bb4f0529408cc0b"><div class="ttname"><a href="PoKeysLibAsync_8h.html#a37a28fc2391a33de6bb4f0529408cc0b">PK_PoNETSetModuleStatusAsync</a></div><div class="ttdeci">int PK_PoNETSetModuleStatusAsync(sPoKeysDevice *device)</div><div class="ttdef"><b>Definition:</b> <a href="PoKeysLibPoNETAsync_8c_source.html#l00091">PoKeysLibPoNETAsync.c:91</a></div></div>
<div class="ttc" id="aPoKeysLibAsync_8h_html_a3c12276881f3b45c56244c9b1aae51d7"><div class="ttname"><a href="PoKeysLibAsync_8h.html#a3c12276881f3b45c56244c9b1aae51d7">PK_PoNETGetModuleLightAsync</a></div><div class="ttdeci">int PK_PoNETGetModuleLightAsync(sPoKeysDevice *device)</div><div class="ttdef"><b>Definition:</b> <a href="PoKeysLibPoNETAsync_8c_source.html#l00127">PoKeysLibPoNETAsync.c:127</a></div></div>
<div class="ttc" id="aPoKeysLibAsync_8h_html_a545d854e41e3d2a894d3e57e16ae5841"><div class="ttname"><a href="PoKeysLibAsync_8h.html#a545d854e41e3d2a894d3e57e16ae5841">PK_PoNETSetModulePWMAsync</a></div><div class="ttdeci">int PK_PoNETSetModulePWMAsync(sPoKeysDevice *device)</div><div class="ttdef"><b>Definition:</b> <a href="PoKeysLibPoNETAsync_8c_source.html#l00104">PoKeysLibPoNETAsync.c:104</a></div></div>
<div class="ttc" id="aPoKeysLibAsync_8h_html_a8d522e5440b51d57c64449f9709f0f5d"><div class="ttname"><a href="PoKeysLibAsync_8h.html#a8d522e5440b51d57c64449f9709f0f5d">PK_PoNETGetModuleStatusAsync</a></div><div class="ttdeci">int PK_PoNETGetModuleStatusAsync(sPoKeysDevice *device)</div><div class="ttdef"><b>Definition:</b> <a href="PoKeysLibPoNETAsync_8c_source.html#l00080">PoKeysLibPoNETAsync.c:80</a></div></div>
<div class="ttc" id="aPoKeysLibAsync_8h_html_abf6e043583e7f2e498881fe18717d3ec"><div class="ttname"><a href="PoKeysLibAsync_8h.html#abf6e043583e7f2e498881fe18717d3ec">PK_PoNETGetModuleSettingsAsync</a></div><div class="ttdeci">int PK_PoNETGetModuleSettingsAsync(sPoKeysDevice *device)</div><div class="ttdef"><b>Definition:</b> <a href="PoKeysLibPoNETAsync_8c_source.html#l00057">PoKeysLibPoNETAsync.c:57</a></div></div>
<div class="ttc" id="aPoKeysLibAsync_8h_html_ae30d618a9ef584142fd9569030f0a842"><div class="ttname"><a href="PoKeysLibAsync_8h.html#ae30d618a9ef584142fd9569030f0a842">PK_PoNETGetPoNETStatusAsync</a></div><div class="ttdeci">int PK_PoNETGetPoNETStatusAsync(sPoKeysDevice *device)</div><div class="ttdef"><b>Definition:</b> <a href="PoKeysLibPoNETAsync_8c_source.html#l00046">PoKeysLibPoNETAsync.c:46</a></div></div>
<div class="ttc" id="aPoKeysLibAsync_8h_html_af2afc2d1a902285c403724e18e0d0d93"><div class="ttname"><a href="PoKeysLibAsync_8h.html#af2afc2d1a902285c403724e18e0d0d93">PK_PoNETGetModuleLightRequestAsync</a></div><div class="ttdeci">int PK_PoNETGetModuleLightRequestAsync(sPoKeysDevice *device)</div><div class="ttdef"><b>Definition:</b> <a href="PoKeysLibPoNETAsync_8c_source.html#l00116">PoKeysLibPoNETAsync.c:116</a></div></div>
<div class="ttc" id="astructsPoKeysDevice_html"><div class="ttname"><a href="structsPoKeysDevice.html">sPoKeysDevice</a></div><div class="ttdef"><b>Definition:</b> <a href="pokeyslib_2PoKeysLib_8h_source.html#l00880">PoKeysLib.h:881</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md294"></a>
‚úÖ &lt;strong&gt;Enhanced kbd48CNC Functions (PoKeysLibPoNETAsyncEnhanced.c) - NEW&lt;/strong&gt;</h2>
<div class="fragment"><div class="line"><span class="comment">// Advanced kbd48CNC Operations - Just Added</span></div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="PoKeysLibAsync_8h.html#abbf8834b3a28fe508ab44e49093fad1a">PK_PoNETKbd48CNCUpdateCycleAsync</a>(<a class="code hl_struct" href="structsPoKeysDevice.html">sPoKeysDevice</a>* device);</div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="PoKeysLibAsync_8h.html#ab41437e73751987ff690ee6be106600e">PK_PoNETKbd48CNCLEDSetPatternAsync</a>(<a class="code hl_struct" href="structsPoKeysDevice.html">sPoKeysDevice</a>* device, <a class="code hl_typedef" href="pokeyslib_2PoKeysLib_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> pattern[6]);</div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="PoKeysLibAsync_8h.html#a617e0b8a5218bd81b7cd87c82c3677dc">PK_PoNETKbd48CNCBrightnessSetAsync</a>(<a class="code hl_struct" href="structsPoKeysDevice.html">sPoKeysDevice</a>* device, <a class="code hl_typedef" href="pokeyslib_2PoKeysLib_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> brightness);</div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="PoKeysLibAsync_8h.html#a97520d849976956f0a57a57e11033ce4">PK_PoNETDeviceDiscoveryAsync</a>(<a class="code hl_struct" href="structsPoKeysDevice.html">sPoKeysDevice</a>* device);</div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="PoKeysLibAsync_8h.html#a2ca760795795083aa3ab999eb42a2311">PK_PoNETModuleReinitializeAsync</a>(<a class="code hl_struct" href="structsPoKeysDevice.html">sPoKeysDevice</a>* device, <a class="code hl_typedef" href="pokeyslib_2PoKeysLib_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> moduleID);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Helper Functions for kbd48CNC</span></div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="PoKeysLibPoNETAsyncEnhanced_8c.html#a395a933a018563560e8329f5c4fc6bb9">PK_PoNETKbd48CNCGetButtonStateAsync</a>(<a class="code hl_struct" href="structsPoKeysDevice.html">sPoKeysDevice</a>* device, <a class="code hl_typedef" href="pokeyslib_2PoKeysLib_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> buttonIndex, <span class="keywordtype">bool</span>* pressed);</div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="PoKeysLibPoNETAsyncEnhanced_8c.html#affad2300b9550820e4cbbaacb2306dbe">PK_PoNETKbd48CNCSetLEDStateAsync</a>(<a class="code hl_struct" href="structsPoKeysDevice.html">sPoKeysDevice</a>* device, <a class="code hl_typedef" href="pokeyslib_2PoKeysLib_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> ledIndex, <span class="keywordtype">bool</span> on);</div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="PoKeysLibPoNETAsyncEnhanced_8c.html#ad55fc345b23fc7e7abf80a1303ba3a6c">PK_PoNETKbd48CNCSetMultipleLEDsAsync</a>(<a class="code hl_struct" href="structsPoKeysDevice.html">sPoKeysDevice</a>* device, <span class="keyword">const</span> <a class="code hl_typedef" href="pokeyslib_2PoKeysLib_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>* ledStates);</div>
<div class="ttc" id="aPoKeysLibAsync_8h_html_a2ca760795795083aa3ab999eb42a2311"><div class="ttname"><a href="PoKeysLibAsync_8h.html#a2ca760795795083aa3ab999eb42a2311">PK_PoNETModuleReinitializeAsync</a></div><div class="ttdeci">int PK_PoNETModuleReinitializeAsync(sPoKeysDevice *device, uint8_t moduleID)</div><div class="ttdef"><b>Definition:</b> <a href="PoKeysLibPoNETAsyncEnhanced_8c_source.html#l00099">PoKeysLibPoNETAsyncEnhanced.c:99</a></div></div>
<div class="ttc" id="aPoKeysLibAsync_8h_html_a617e0b8a5218bd81b7cd87c82c3677dc"><div class="ttname"><a href="PoKeysLibAsync_8h.html#a617e0b8a5218bd81b7cd87c82c3677dc">PK_PoNETKbd48CNCBrightnessSetAsync</a></div><div class="ttdeci">int PK_PoNETKbd48CNCBrightnessSetAsync(sPoKeysDevice *device, uint8_t brightness)</div><div class="ttdef"><b>Definition:</b> <a href="PoKeysLibPoNETAsyncEnhanced_8c_source.html#l00075">PoKeysLibPoNETAsyncEnhanced.c:75</a></div></div>
<div class="ttc" id="aPoKeysLibAsync_8h_html_a97520d849976956f0a57a57e11033ce4"><div class="ttname"><a href="PoKeysLibAsync_8h.html#a97520d849976956f0a57a57e11033ce4">PK_PoNETDeviceDiscoveryAsync</a></div><div class="ttdeci">int PK_PoNETDeviceDiscoveryAsync(sPoKeysDevice *device)</div><div class="ttdef"><b>Definition:</b> <a href="PoKeysLibPoNETAsyncEnhanced_8c_source.html#l00087">PoKeysLibPoNETAsyncEnhanced.c:87</a></div></div>
<div class="ttc" id="aPoKeysLibAsync_8h_html_ab41437e73751987ff690ee6be106600e"><div class="ttname"><a href="PoKeysLibAsync_8h.html#ab41437e73751987ff690ee6be106600e">PK_PoNETKbd48CNCLEDSetPatternAsync</a></div><div class="ttdeci">int PK_PoNETKbd48CNCLEDSetPatternAsync(sPoKeysDevice *device, uint8_t pattern[6])</div><div class="ttdef"><b>Definition:</b> <a href="PoKeysLibPoNETAsyncEnhanced_8c_source.html#l00063">PoKeysLibPoNETAsyncEnhanced.c:63</a></div></div>
<div class="ttc" id="aPoKeysLibAsync_8h_html_abbf8834b3a28fe508ab44e49093fad1a"><div class="ttname"><a href="PoKeysLibAsync_8h.html#abbf8834b3a28fe508ab44e49093fad1a">PK_PoNETKbd48CNCUpdateCycleAsync</a></div><div class="ttdeci">int PK_PoNETKbd48CNCUpdateCycleAsync(sPoKeysDevice *device)</div><div class="ttdef"><b>Definition:</b> <a href="PoKeysLibPoNETAsyncEnhanced_8c_source.html#l00018">PoKeysLibPoNETAsyncEnhanced.c:18</a></div></div>
<div class="ttc" id="aPoKeysLibPoNETAsyncEnhanced_8c_html_a395a933a018563560e8329f5c4fc6bb9"><div class="ttname"><a href="PoKeysLibPoNETAsyncEnhanced_8c.html#a395a933a018563560e8329f5c4fc6bb9">PK_PoNETKbd48CNCGetButtonStateAsync</a></div><div class="ttdeci">int PK_PoNETKbd48CNCGetButtonStateAsync(sPoKeysDevice *device, uint8_t buttonIndex, bool *pressed)</div><div class="ttdef"><b>Definition:</b> <a href="PoKeysLibPoNETAsyncEnhanced_8c_source.html#l00134">PoKeysLibPoNETAsyncEnhanced.c:134</a></div></div>
<div class="ttc" id="aPoKeysLibPoNETAsyncEnhanced_8c_html_ad55fc345b23fc7e7abf80a1303ba3a6c"><div class="ttname"><a href="PoKeysLibPoNETAsyncEnhanced_8c.html#ad55fc345b23fc7e7abf80a1303ba3a6c">PK_PoNETKbd48CNCSetMultipleLEDsAsync</a></div><div class="ttdeci">int PK_PoNETKbd48CNCSetMultipleLEDsAsync(sPoKeysDevice *device, const uint8_t *ledStates)</div><div class="ttdef"><b>Definition:</b> <a href="PoKeysLibPoNETAsyncEnhanced_8c_source.html#l00179">PoKeysLibPoNETAsyncEnhanced.c:179</a></div></div>
<div class="ttc" id="aPoKeysLibPoNETAsyncEnhanced_8c_html_affad2300b9550820e4cbbaacb2306dbe"><div class="ttname"><a href="PoKeysLibPoNETAsyncEnhanced_8c.html#affad2300b9550820e4cbbaacb2306dbe">PK_PoNETKbd48CNCSetLEDStateAsync</a></div><div class="ttdeci">int PK_PoNETKbd48CNCSetLEDStateAsync(sPoKeysDevice *device, uint8_t ledIndex, bool on)</div><div class="ttdef"><b>Definition:</b> <a href="PoKeysLibPoNETAsyncEnhanced_8c_source.html#l00156">PoKeysLibPoNETAsyncEnhanced.c:156</a></div></div>
<div class="ttc" id="apokeyslib_2PoKeysLib_8h_html_aba7bc1797add20fe3efdf37ced1182c5"><div class="ttname"><a href="pokeyslib_2PoKeysLib_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a></div><div class="ttdeci">unsigned char uint8_t</div><div class="ttdef"><b>Definition:</b> <a href="pokeyslib_2PoKeysLib_8h_source.html#l00034">PoKeysLib.h:34</a></div></div>
</div><!-- fragment --><hr  />
<h1><a class="anchor" id="autotoc_md296"></a>
üîç &lt;strong&gt;Key Findings from PoKeysCompPoNet.c Analysis&lt;/strong&gt;</h1>
<h2><a class="anchor" id="autotoc_md297"></a>
&lt;strong&gt;kbd48CNC Device Characteristics:&lt;/strong&gt;</h2>
<ul>
<li><b>48 Buttons</b>: Mapped through complex 4-group offset scheme</li>
<li><b>48 LEDs</b>: Individual control for each button backlight</li>
<li><b>Light Sensor</b>: Automatic brightness adjustment based on ambient light</li>
<li><b>PWM Brightness</b>: 0-255 range with inverted logic (255 = bright)</li>
<li><b>PoNET Protocol</b>: Uses I2C communication via PK_CMD_POI2C_COMMUNICATION</li>
</ul>
<h2><a class="anchor" id="autotoc_md298"></a>
&lt;strong&gt;HAL Integration Pattern:&lt;/strong&gt;</h2>
<div class="fragment"><div class="line"><span class="comment">// From PoKeysCompPoNet.c - HAL Pin Creation</span></div>
<div class="line">pokeys.0.kbd48CNC.available           <span class="comment">// Detection flag</span></div>
<div class="line">pokeys.0.kbd48CNC.PoNetID             <span class="comment">// Module ID (0-15)</span></div>
<div class="line">pokeys.0.kbd48CNC.lightValue          <span class="comment">// Ambient light sensor (0-255)</span></div>
<div class="line">pokeys.0.kbd48CNC.KeyBrightness       <span class="comment">// Calculated brightness (0-255)</span></div>
<div class="line">pokeys.0.kbd48CNC.prevBrightness      <span class="comment">// Previous brightness value</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Individual button/LED pins (0-47)</span></div>
<div class="line">pokeys.0.kbd48CNC.0.Button            <span class="comment">// Button input state</span></div>
<div class="line">pokeys.0.kbd48CNC.0.LED               <span class="comment">// LED output control</span></div>
<div class="line"><span class="comment">// ... repeated for all 48 buttons/LEDs</span></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md299"></a>
&lt;strong&gt;Complex Button Mapping Logic:&lt;/strong&gt;</h2>
<p >The kbd48CNC uses a sophisticated remapping scheme to convert logical button indices (0-47) to physical device IDs:</p>
<div class="fragment"><div class="line"><span class="comment">// From PoKeysCompPoNet.c - Button ID Mapping</span></div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_struct" href="structoffset__struct.html">offset</a>[] = { 15, 8, 7, 0 };</div>
<div class="line"><span class="keywordtype">int</span> top = (<a class="code hl_variable" href="pokeys_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> &amp; 0xF0) + <a class="code hl_struct" href="structoffset__struct.html">offset</a>[(<a class="code hl_variable" href="pokeys_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> / 4) % 4];</div>
<div class="line"><span class="keywordtype">int</span> y = <a class="code hl_variable" href="pokeys_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> % 4;</div>
<div class="line"><span class="keywordtype">int</span> ID = top + y;</div>
<div class="line"><span class="keywordflow">if</span> (((<a class="code hl_variable" href="pokeys_8c.html#acb559820d9ca11295b4500f179ef6392">i</a> / 4) % 2) == 0) {</div>
<div class="line">    ID = top - y;</div>
<div class="line">}</div>
<div class="ttc" id="apokeys_8c_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="pokeys_8c.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> <a href="pokeys_8c_source.html#l00970">pokeys.c:970</a></div></div>
<div class="ttc" id="astructoffset__struct_html"><div class="ttname"><a href="structoffset__struct.html">offset_struct</a></div><div class="ttdef"><b>Definition:</b> <a href="interp__internal_8hh_source.html#l00615">interp_internal.hh:615</a></div></div>
</div><!-- fragment --><p >This complex mapping is <b>now implemented in our enhanced async functions</b>.</p>
<hr  />
<h1><a class="anchor" id="autotoc_md301"></a>
üöÄ &lt;strong&gt;New Async Implementation Features&lt;/strong&gt;</h1>
<h2><a class="anchor" id="autotoc_md302"></a>
1. &lt;strong&gt;Complete Update Cycle Function&lt;/strong&gt;</h2>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="PoKeysLibAsync_8h.html#abbf8834b3a28fe508ab44e49093fad1a">PK_PoNETKbd48CNCUpdateCycleAsync</a>(<a class="code hl_struct" href="structsPoKeysDevice.html">sPoKeysDevice</a>* device)</div>
</div><!-- fragment --><ul>
<li><b>Combines all kbd48CNC operations</b> in a single async function</li>
<li><b>Sequence</b>: Module settings ‚Üí Light sensor ‚Üí Button status ‚Üí LED update ‚Üí PWM brightness</li>
<li><b>RT-Safe</b>: Non-blocking with proper error handling</li>
<li><b>Efficient</b>: Reduces multiple async calls to one comprehensive operation</li>
</ul>
<h2><a class="anchor" id="autotoc_md303"></a>
2. &lt;strong&gt;Enhanced LED Control&lt;/strong&gt;</h2>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="PoKeysLibAsync_8h.html#ab41437e73751987ff690ee6be106600e">PK_PoNETKbd48CNCLEDSetPatternAsync</a>(<a class="code hl_struct" href="structsPoKeysDevice.html">sPoKeysDevice</a>* device, <a class="code hl_typedef" href="pokeyslib_2PoKeysLib_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> pattern[6])</div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="PoKeysLibPoNETAsyncEnhanced_8c.html#ad55fc345b23fc7e7abf80a1303ba3a6c">PK_PoNETKbd48CNCSetMultipleLEDsAsync</a>(<a class="code hl_struct" href="structsPoKeysDevice.html">sPoKeysDevice</a>* device, <span class="keyword">const</span> <a class="code hl_typedef" href="pokeyslib_2PoKeysLib_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a>* ledStates)</div>
</div><!-- fragment --><ul>
<li><b>Pattern Support</b>: Set multiple LEDs with single call</li>
<li><b>Batch Operations</b>: Efficient multi-LED updates</li>
<li><b>Physical Mapping</b>: Handles complex kbd48CNC button ID mapping</li>
</ul>
<h2><a class="anchor" id="autotoc_md304"></a>
3. &lt;strong&gt;Automatic Brightness Control&lt;/strong&gt;</h2>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="PoKeysLibAsync_8h.html#a617e0b8a5218bd81b7cd87c82c3677dc">PK_PoNETKbd48CNCBrightnessSetAsync</a>(<a class="code hl_struct" href="structsPoKeysDevice.html">sPoKeysDevice</a>* device, <a class="code hl_typedef" href="pokeyslib_2PoKeysLib_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> brightness)</div>
</div><!-- fragment --><ul>
<li><b>Inverted Logic Handling</b>: Automatically converts brightness to PWM duty cycle</li>
<li><b>Range</b>: 0-255 brightness maps to 255-0 PWM duty (kbd48CNC hardware requirement)</li>
<li><b>Immediate Update</b>: Async PWM update with proper error handling</li>
</ul>
<h2><a class="anchor" id="autotoc_md305"></a>
4. &lt;strong&gt;Advanced Device Management&lt;/strong&gt;</h2>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="PoKeysLibAsync_8h.html#a97520d849976956f0a57a57e11033ce4">PK_PoNETDeviceDiscoveryAsync</a>(<a class="code hl_struct" href="structsPoKeysDevice.html">sPoKeysDevice</a>* device)</div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="PoKeysLibAsync_8h.html#a2ca760795795083aa3ab999eb42a2311">PK_PoNETModuleReinitializeAsync</a>(<a class="code hl_struct" href="structsPoKeysDevice.html">sPoKeysDevice</a>* device, <a class="code hl_typedef" href="pokeyslib_2PoKeysLib_8h.html#aba7bc1797add20fe3efdf37ced1182c5">uint8_t</a> moduleID)</div>
</div><!-- fragment --><ul>
<li><b>Device Discovery</b>: Scan for available PoNET modules</li>
<li><b>Error Recovery</b>: Reinitialize modules after communication failures</li>
<li><b>Production Ready</b>: Essential for robust industrial applications</li>
</ul>
<hr  />
<h1><a class="anchor" id="autotoc_md307"></a>
üìä &lt;strong&gt;Protocol Coverage Analysis&lt;/strong&gt;</h1>
<h2><a class="anchor" id="autotoc_md308"></a>
&lt;strong&gt;PoNET Operations Implemented:&lt;/strong&gt;</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Operation   </th><th class="markdownTableHeadNone">Sync (Original)   </th><th class="markdownTableHeadNone">Basic Async   </th><th class="markdownTableHeadNone">Enhanced Async   </th><th class="markdownTableHeadNone">Coverage    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>GET_STATUS</b>   </td><td class="markdownTableBodyNone">‚úÖ   </td><td class="markdownTableBodyNone">‚úÖ   </td><td class="markdownTableBodyNone">‚úÖ   </td><td class="markdownTableBodyNone">Complete    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>GET_MODULE_SETTINGS</b>   </td><td class="markdownTableBodyNone">‚úÖ   </td><td class="markdownTableBodyNone">‚úÖ   </td><td class="markdownTableBodyNone">‚úÖ   </td><td class="markdownTableBodyNone">Complete    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>GET_MODULE_DATA</b>   </td><td class="markdownTableBodyNone">‚úÖ   </td><td class="markdownTableBodyNone">‚úÖ   </td><td class="markdownTableBodyNone">‚úÖ   </td><td class="markdownTableBodyNone">Complete    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>SET_MODULE_DATA</b>   </td><td class="markdownTableBodyNone">‚úÖ   </td><td class="markdownTableBodyNone">‚úÖ   </td><td class="markdownTableBodyNone">‚úÖ   </td><td class="markdownTableBodyNone">Complete    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>GET_LIGHT_SENSOR</b>   </td><td class="markdownTableBodyNone">‚úÖ   </td><td class="markdownTableBodyNone">‚úÖ   </td><td class="markdownTableBodyNone">‚úÖ   </td><td class="markdownTableBodyNone">Complete    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>SET_PWM_VALUE</b>   </td><td class="markdownTableBodyNone">‚úÖ   </td><td class="markdownTableBodyNone">‚úÖ   </td><td class="markdownTableBodyNone">‚úÖ   </td><td class="markdownTableBodyNone">Complete    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>DEVICE_DISCOVERY</b>   </td><td class="markdownTableBodyNone">‚úÖ   </td><td class="markdownTableBodyNone">‚ùå   </td><td class="markdownTableBodyNone">‚úÖ   </td><td class="markdownTableBodyNone">Enhanced    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>REINITIALIZE</b>   </td><td class="markdownTableBodyNone">‚úÖ   </td><td class="markdownTableBodyNone">‚ùå   </td><td class="markdownTableBodyNone">‚úÖ   </td><td class="markdownTableBodyNone">Enhanced    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>Combined Operations</b>   </td><td class="markdownTableBodyNone">‚ùå   </td><td class="markdownTableBodyNone">‚ùå   </td><td class="markdownTableBodyNone">‚úÖ   </td><td class="markdownTableBodyNone">New   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md309"></a>
&lt;strong&gt;kbd48CNC Specific Features:&lt;/strong&gt;</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Feature   </th><th class="markdownTableHeadNone">Implementation   </th><th class="markdownTableHeadNone">Status    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>48 Button Reading</b>   </td><td class="markdownTableBodyNone">Individual + Batch   </td><td class="markdownTableBodyNone">‚úÖ Complete    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>48 LED Control</b>   </td><td class="markdownTableBodyNone">Individual + Pattern   </td><td class="markdownTableBodyNone">‚úÖ Complete    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>Light Sensor</b>   </td><td class="markdownTableBodyNone">Automatic Reading   </td><td class="markdownTableBodyNone">‚úÖ Complete    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>Brightness Control</b>   </td><td class="markdownTableBodyNone">PWM with Inversion   </td><td class="markdownTableBodyNone">‚úÖ Complete    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>Button ID Mapping</b>   </td><td class="markdownTableBodyNone">Complex 4-Group Logic   </td><td class="markdownTableBodyNone">‚úÖ Complete    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><b>Batch Operations</b>   </td><td class="markdownTableBodyNone">Multi-LED Updates   </td><td class="markdownTableBodyNone">‚úÖ Enhanced    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><b>Error Recovery</b>   </td><td class="markdownTableBodyNone">Module Reinitialize   </td><td class="markdownTableBodyNone">‚úÖ Enhanced   </td></tr>
</table>
<hr  />
<h1><a class="anchor" id="autotoc_md311"></a>
üèóÔ∏è &lt;strong&gt;LinuxCNC Integration Readiness&lt;/strong&gt;</h1>
<h2><a class="anchor" id="autotoc_md312"></a>
&lt;strong&gt;HAL Component Compatibility:&lt;/strong&gt;</h2>
<p >Our async implementation now <b>fully supports the HAL integration pattern</b> shown in <a class="el" href="PoKeysCompPoNet_8c.html">PoKeysCompPoNet.c</a>:</p>
<div class="fragment"><div class="line"><span class="comment">// Async functions support the same operations as sync version:</span></div>
<div class="line"><span class="comment">// 1. Device detection and setup</span></div>
<div class="line"><a class="code hl_function" href="PoKeysLibAsync_8h.html#abf6e043583e7f2e498881fe18717d3ec">PK_PoNETGetModuleSettingsAsync</a>(device);        <span class="comment">// Check if kbd48CNC present</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// 2. Runtime operations  </span></div>
<div class="line"><a class="code hl_function" href="PoKeysLibAsync_8h.html#abbf8834b3a28fe508ab44e49093fad1a">PK_PoNETKbd48CNCUpdateCycleAsync</a>(device);      <span class="comment">// Complete update cycle</span></div>
<div class="line"><a class="code hl_function" href="PoKeysLibAsync_8h.html#a617e0b8a5218bd81b7cd87c82c3677dc">PK_PoNETKbd48CNCBrightnessSetAsync</a>(device, brightness);  <span class="comment">// Brightness control</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// 3. Individual I/O operations</span></div>
<div class="line"><a class="code hl_function" href="PoKeysLibPoNETAsyncEnhanced_8c.html#a395a933a018563560e8329f5c4fc6bb9">PK_PoNETKbd48CNCGetButtonStateAsync</a>(device, buttonIndex, &amp;pressed);  <span class="comment">// Button read</span></div>
<div class="line"><a class="code hl_function" href="PoKeysLibPoNETAsyncEnhanced_8c.html#affad2300b9550820e4cbbaacb2306dbe">PK_PoNETKbd48CNCSetLEDStateAsync</a>(device, ledIndex, on);             <span class="comment">// LED control</span></div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md313"></a>
&lt;strong&gt;RT Performance Benefits:&lt;/strong&gt;</h2>
<ul>
<li><b>Non-blocking Operations</b>: No RT thread violations</li>
<li><b>Batch Updates</b>: Reduced communication overhead</li>
<li><b>Error Recovery</b>: Automatic retry and reinitialize capabilities</li>
<li><b>Memory Efficiency</b>: Uses hal_malloc for RT-safe allocation</li>
</ul>
<hr  />
<h1><a class="anchor" id="autotoc_md315"></a>
üéØ &lt;strong&gt;Implementation Completeness Assessment&lt;/strong&gt;</h1>
<h2><a class="anchor" id="autotoc_md316"></a>
‚úÖ &lt;strong&gt;EXCELLENT Coverage Achieved:&lt;/strong&gt;</h2>
<ol type="1">
<li><b>Protocol Completeness</b>: All PoNET operations implemented with async versions</li>
<li><b>kbd48CNC Specific</b>: Enhanced functions for all kbd48CNC features</li>
<li><b>Button Mapping</b>: Complex physical-to-logical mapping implemented correctly</li>
<li><b>HAL Compatibility</b>: Supports same integration pattern as sync version</li>
<li><b>RT Safety</b>: All functions designed for hard real-time LinuxCNC threads</li>
<li><b>Error Handling</b>: Comprehensive error recovery and device management</li>
<li><b>Production Ready</b>: Advanced features for industrial CNC applications</li>
</ol>
<h2><a class="anchor" id="autotoc_md317"></a>
&lt;strong&gt;Missing Elements: NONE&lt;/strong&gt;</h2>
<p >After comprehensive analysis, <b>no missing kbd48CNC or PoNET functionality</b> was identified. Our async implementation now <b>exceeds the capabilities</b> of the original sync implementation with:</p>
<ul>
<li><b>Enhanced batch operations</b> not available in sync version</li>
<li><b>Advanced error recovery</b> functions</li>
<li><b>RT-optimized combined operations</b></li>
<li><b>Production-grade device management</b></li>
</ul>
<hr  />
<h1><a class="anchor" id="autotoc_md319"></a>
üèÜ &lt;strong&gt;Final Status: kbd48CNC COMPLETE&lt;/strong&gt;</h1>
<h2><a class="anchor" id="autotoc_md320"></a>
&lt;strong&gt;Assessment Conclusion:&lt;/strong&gt;</h2>
<p >The PoKeys async library now has <b>comprehensive and enhanced support</b> for:</p>
<p >‚úÖ <b>All PoNET Operations</b> - Complete protocol coverage ‚úÖ <b>Full kbd48CNC Support</b> - All 48 buttons, LEDs, brightness, light sensor ‚úÖ <b>Complex Button Mapping</b> - Exact implementation of 4-group mapping logic <br  />
 ‚úÖ <b>HAL Integration Ready</b> - Compatible with existing LinuxCNC patterns ‚úÖ <b>RT-Safe Design</b> - Non-blocking operations for hard real-time threads ‚úÖ <b>Enhanced Features</b> - Batch operations and advanced device management ‚úÖ <b>Production Quality</b> - Error recovery and robust communication handling</p>
<h2><a class="anchor" id="autotoc_md321"></a>
&lt;strong&gt;Status: üéâ MISSION ACCOMPLISHED&lt;/strong&gt;</h2>
<p ><b>Our async library implementation is now COMPLETE with comprehensive kbd48CNC and PoNET support that matches and exceeds the original sync implementation capabilities.</b></p>
<p >The kbd48CNC analysis revealed that our async library was already very comprehensive, and with the addition of the enhanced functions, we now have <b>production-ready support for all PoNET devices including the complex kbd48CNC keyboard/display units commonly used in professional CNC applications.</b> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.4 </li>
  </ul>
</div>
</body>
</html>
